<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Map Stream Overlay</title>
	<style>
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
		}

		body {
			background: #000000;
			width: 100vw;
			height: 100vh;
			overflow: hidden;
			display: flex;
			justify-content: center;
			align-items: center;
		}

		#map {
			width: 100vh;
			aspect-ratio: 9/16;
			position: relative;
		}
	</style>
</head>

<body>
	<div id="map"></div>

	<script>
		// Replace with your actual Google Maps API key
		const GOOGLE_MAPS_API_KEY = 'AIzaSyATFVb_BO1HhFGZ8m0PMe7uy2F4T2KW6ZQ';

		let map;
		let markers = {};
		let userLocation = null;
		let animationInterval;
		const UPDATE_INTERVAL = 100; // Update every 100ms for smooth movement

		// Initial coordinates - tightly clustered
		let coordinates = [
			{
				id: 'foo',
				latitude: 37.7749,
				longitude: -122.4194,
				color: '#FF6B6B',
				velocity: { lat: 0, lng: 0 }
			},
			{
				id: 'bar',
				latitude: 37.774905,
				longitude: -122.419395,
				color: '#4ECDC4',
				velocity: { lat: 0, lng: 0 }
			},
			{
				id: 'baz',
				latitude: 37.774895,
				longitude: -122.419405,
				color: '#45B7D1',
				velocity: { lat: 0, lng: 0 }
			},
			{
				id: 'qux',
				latitude: 37.77491,
				longitude: -122.41941,
				color: '#96CEB4',
				velocity: { lat: 0, lng: 0 }
			}
		];

		// Load Google Maps API
		function loadGoogleMaps() {
			const script = document.createElement('script');
			script.src = `https://maps.googleapis.com/maps/api/js?key=${GOOGLE_MAPS_API_KEY}&callback=initMap`;
			script.async = true;
			script.defer = true;
			document.head.appendChild(script);
		}

		// Initialize the map
		function initMap() {
			// Try to get user's location
			if (navigator.geolocation) {
				navigator.geolocation.getCurrentPosition(
					(position) => {
						userLocation = {
							lat: position.coords.latitude,
							lng: position.coords.longitude
						};
						setupMap(userLocation);
						initializeCoordinatesNearUser();
					},
					(error) => {
						console.warn('Geolocation failed:', error);
						// Use default location (San Francisco)
						userLocation = { lat: 37.7749, lng: -122.4194 };
						setupMap(userLocation);
					}
				);
			} else {
				// Browser doesn't support geolocation
				userLocation = { lat: 37.7749, lng: -122.4194 };
				setupMap(userLocation);
			}
		}

		function setupMap(center) {
			map = new google.maps.Map(document.getElementById('map'), {
				center: center,
				zoom: 21, // Maximum zoom for close detail
				mapTypeId: 'satellite',
				disableDefaultUI: true, // Remove all UI elements
				gestureHandling: 'none', // Disable user interaction
				keyboardShortcuts: false,
				clickableIcons: false,
				disableDoubleClickZoom: true,
				scrollwheel: false,
				styles: [
					{
						featureType: 'all',
						elementType: 'labels',
						stylers: [{ visibility: 'off' }]
					}
				]
			});

			// Initialize coordinate markers
			updateMarkers();

			// Start animation
			startAnimation();
		}

		function initializeCoordinatesNearUser() {
			// Place all coordinates in a tight cluster near the user
			const baseLat = userLocation.lat;
			const baseLng = userLocation.lng;

			// Very small offset for tight clustering (about 1-2 meters apart)
			coordinates = coordinates.map((coord, index) => {
				const offsetLat = (index % 2) * 0.00001 - 0.000005;
				const offsetLng = (Math.floor(index / 2)) * 0.00001 - 0.000005;

				return {
					...coord,
					latitude: baseLat + offsetLat,
					longitude: baseLng + offsetLng,
					velocity: { lat: 0, lng: 0 }
				};
			});
		}

		function updateMarkers() {
			coordinates.forEach(coord => {
				if (markers[coord.id]) {
					// Smoothly update existing marker position
					markers[coord.id].setPosition({
						lat: coord.latitude,
						lng: coord.longitude
					});
				} else {
					// Create new marker
					markers[coord.id] = new google.maps.Marker({
						position: { lat: coord.latitude, lng: coord.longitude },
						map: map,
						title: coord.id,
						icon: {
							path: google.maps.SymbolPath.CIRCLE,
							scale: 10,
							fillColor: coord.color || '#FF6B6B',
							fillOpacity: 0.9,
							strokeColor: '#ffffff',
							strokeWeight: 2
						}
					});
				}
			});

			// Adjust map bounds to show all markers
			fitMapToBounds();
		}

		function fitMapToBounds() {
			const bounds = new google.maps.LatLngBounds();

			// Include all coordinate points
			coordinates.forEach(coord => {
				bounds.extend({ lat: coord.latitude, lng: coord.longitude });
			});

			map.fitBounds(bounds);

			// Keep maximum zoom for close detail
			const listener = google.maps.event.addListener(map, 'idle', () => {
				if (map.getZoom() < 19) {
					map.setZoom(19);
				}
				google.maps.event.removeListener(listener);
			});
		}

		// Simulate slow walking speed (1-2 feet per second)
		function getCoordinateUpdates() {
			coordinates = coordinates.map(coord => {
				// Change direction occasionally (every ~5 seconds on average)
				if (Math.random() < 0.02) { // 2% chance per 100ms update
					// 1-2 feet per second = 0.3-0.6 meters per second
					// At equator: 1 degree latitude = 111,139 meters
					// So 0.5 meters = 0.0000045 degrees
					// This gives us movement of about 0.5 meters per second
					const speed = 0.0000045 / 10; // Divide by 10 for 100ms intervals

					// Random direction
					const angle = Math.random() * 2 * Math.PI;
					coord.velocity = {
						lat: Math.cos(angle) * speed,
						lng: Math.sin(angle) * speed
					};
				}

				// Apply velocity with some randomness for natural movement
				const randomFactor = 0.8 + Math.random() * 0.4; // 80% to 120% of velocity

				return {
					...coord,
					latitude: coord.latitude + coord.velocity.lat * randomFactor,
					longitude: coord.longitude + coord.velocity.lng * randomFactor
				};
			});

			return coordinates;
		}

		function startAnimation() {
			animationInterval = setInterval(() => {
				getCoordinateUpdates();
				updateMarkers();
			}, UPDATE_INTERVAL);
		}

		// Initialize everything when the page loads
		window.onload = () => {
			loadGoogleMaps();
		};
	</script>
</body>

</html>